<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.css' rel='stylesheet' />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-92988185-1', 'auto');
      ga('send', 'pageview');
    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <style>
        body {
          margin:0;
          padding:0;
          background-color: #024872
        }
        #app {
          background-color: rgb(193, 193, 193);
          padding: 0;
        }
        #map img {
         max-width: none;
         min-width: 0px;
        }
        #map {
          height: 500px;
        }
        #moreinfo {
          background-color: white;
        }
        #menu {
            background: #fff;
            position: absolute;
            z-index: 1;
            top: 10px;
            right: 10px;
            border-radius: 3px;
            width: 120px;
            border: 1px solid rgba(0,0,0,0.4);
            font-family: 'Open Sans', sans-serif;
        }

        #menu a {
            font-size: 13px;
            color: #404040;
            display: block;
            margin: 0;
            padding: 0;
            padding: 10px;
            text-decoration: none;
            border-bottom: 1px solid rgba(0,0,0,0.25);
            text-align: center;
        }

        #menu a:last-child {
            border: none;
        }

        #menu a:hover {
            background-color: #f8f8f8;
            color: #404040;
        }

        #menu a.active {
            background-color: #3887be;
            color: #ffffff;
        }

        #menu a.active:hover {
            background: #3074a4;
        }
    </style>
 </script>
</head>
<body>
<style>
  .mapboxgl-popup {
      max-width: 400px;
      font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  }
  #stripeButton {
    margin-left: 10px;
    margin-top: 8px;
  }
</style>

<div class="navbar navbar-fixed-top">
  <div class="col-sm-2 col-md-3"></div>
  <a href="https://goo.gl/forms/SywPzbw4TqMzvjj23" class="col-xs-12 col-sm-8 col-md-6 btn btn-sm btn-success"><h4>Like what you see? Click here to register your details...</h4></a>
  <form action="/" method="POST">
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <button id="stripeButton" class="btn btn-danger">Pay Now! $10.00</button>
  </form>
  <div id="menu"></div>
</div>

<div class="container" id="app">
    <img class="col-xs-12" src="thinbanner.png">
    <div class="col-xs-12">
      <div id="map"></div>
    </div>
    <img class="col-xs-12" src="domain.png">
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script>
var handler = StripeCheckout.configure({
  //key: 'pk_test_dX5xPGvBB6zbfySOJG8eALmp',
  key: 'pk_live_owwh0kLSGLTCF8i4D7aPFcsG',
  image: 'https://stripe.com/img/documentation/checkout/marketplace.png',
  locale: 'auto',
  token: function(token) {
    // You can access the token ID with `token.id`.
    // Get the token ID to your server-side code for use.
    console.log(token);
    $.ajax({
      type: "POST",
      url: 'https://hooks.zapier.com/hooks/catch/1200677/mafo8f/',
      data: token
    });
  }
});

document.getElementById('stripeButton').addEventListener('click', function(e) {
  // Open Checkout with further options:
  handler.open({
    name: 'Property Buddy',
    description: 'Suburb Report',
    zipCode: false,
    currency: 'aud',
    amount: 1000
  });
  e.preventDefault();
});

// Close Checkout on page navigation:
window.addEventListener('popstate', function() {
  handler.close();
});
</script>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoibG13cmlnaHQ4OSIsImEiOiJjaXp2MmI5bm8wMHB2MnduaDdkcWV0OWV0In0.yVDv6j4s-4f11Lhu-EQw1w';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/lmwright89/cizv2bzpp000o2smj7927zc2k',
    zoom: 14,
    center: [153.037,-27.493]
});

var popup = new mapboxgl.Popup({
    closeButton: false,
    closeOnClick: false
});

var toggleableLayerIds = [
  'Crime Data',
  'Heritage - Local',
  'Heritage - State',
  'Master Plan',
  'Proposed',
  'Under Construction',
  'River Flood'
];

map.on('mousemove', function(e) {
    var features = map.queryRenderedFeatures(e.point, {
      layers: toggleableLayerIds
    });
    // Change the cursor style as a UI indicator.
    map.getCanvas().style.cursor = (features.length) ? 'pointer' : '';

    if (!features.length) {
      popup.remove();
      return;
    }

    var feature = features[0];
    var coordinates = null;
    if (feature.geometry.type == 'Point') {
      coordinates = feature.geometry.coordinates;
    } else if (feature.geometry.type == 'Polygon') {
      coordinates = feature.geometry.coordinates[0][0];
    } else if (feature.geometry.type == 'MultiPolygon') {
      coordinates = feature.geometry.coordinates[0][0][0];
    } else {
      //console.log('else', feature.geometry);
    }
    // Populate the popup and set its coordinates
    // based on the feature found.
    if (coordinates) {
      popup.setLngLat(coordinates)
          .setHTML(feature.layer.id)
          .addTo(map);
    }
});


for (var i = 0; i < toggleableLayerIds.length; i++) {
    var id = toggleableLayerIds[i];

    var link = document.createElement('a');
    link.href = '#';
    link.className = 'active';
    link.textContent = id;

    link.onclick = function (e) {
        var clickedLayer = this.textContent;
        e.preventDefault();
        e.stopPropagation();

        var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

        if (visibility === 'visible') {
            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
            this.className = '';
        } else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
        }
    };

    var layers = document.getElementById('menu');
    layers.appendChild(link);
}


</script>

</body>
</html>
